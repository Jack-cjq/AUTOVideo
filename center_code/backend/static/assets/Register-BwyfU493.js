import{_ as C,u as R,r as g,o as h,a as E,c as P,b as q,d as t,e as s,w as a,f as m,g as A,h as _,t as B,E as p,k as I}from"./index-Cc1A4YXN.js";const $={class:"auth-page"},N={class:"auth-card"},S={class:"code-row"},z={class:"auth-footer"},T={__name:"Register",setup(Z){const v=A(),b=R(),c=g(null),f=g(!1),n=g(0);let u=null;h(()=>{u&&(clearInterval(u),u=null)});const r=E({username:"",email:"",code:"",password:"",confirmPassword:""}),V={username:[{required:!0,message:"用户名不能为空",trigger:"blur"}],email:[{required:!0,message:"邮箱不能为空",trigger:"blur"},{type:"email",message:"邮箱格式不正确",trigger:"blur"}],code:[{required:!0,message:"验证码不能为空",trigger:"blur"}],password:[{required:!0,message:"密码不能为空",trigger:"blur"},{min:8,message:"密码至少8个字符",trigger:"blur"},{pattern:/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/,message:"密码必须包含大小写字母、数字和特殊字符",trigger:"blur"}],confirmPassword:[{validator:(d,e,l)=>{if(!e){l(new Error("请确认密码"));return}if(e!==r.password){l(new Error("两次密码不一致"));return}l()},trigger:"blur"}]},y=async()=>{if(!r.email){p.error("请先输入邮箱");return}try{await I.auth.sendCode(r.email),p.success("验证码已发送"),n.value=60,u=setInterval(()=>{if(n.value<=1){clearInterval(u),n.value=0;return}n.value-=1},1e3)}catch(d){p.error(d.message||"发送验证码失败")}},k=async()=>{c.value&&await c.value.validate(async d=>{if(!d)return;f.value=!0;const e=await b.register({username:r.username,email:r.email,password:r.password,code:r.code});f.value=!1,e.success?(p.success("注册成功，请登录"),v.push("/login")):p.error(e.message||"注册失败")})};return(d,e)=>{const l=m("el-input"),i=m("el-form-item"),w=m("el-button"),U=m("el-form"),x=m("router-link");return q(),P("div",$,[t("div",N,[e[8]||(e[8]=t("div",{class:"brand"},[t("div",{class:"brand-mark"},"AUTO"),t("div",{class:"brand-title"},"注册账号"),t("div",{class:"brand-subtitle"},"使用邮箱注册")],-1)),s(U,{ref_key:"formRef",ref:c,model:r,rules:V,"label-position":"top"},{default:a(()=>[s(i,{label:"用户名",prop:"username"},{default:a(()=>[s(l,{modelValue:r.username,"onUpdate:modelValue":e[0]||(e[0]=o=>r.username=o),placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),s(i,{label:"邮箱",prop:"email"},{default:a(()=>[s(l,{modelValue:r.email,"onUpdate:modelValue":e[1]||(e[1]=o=>r.email=o),placeholder:"you@example.com"},null,8,["modelValue"])]),_:1}),s(i,{label:"验证码",prop:"code"},{default:a(()=>[t("div",S,[s(l,{modelValue:r.code,"onUpdate:modelValue":e[2]||(e[2]=o=>r.code=o),placeholder:"6位验证码"},null,8,["modelValue"]),s(w,{disabled:n.value>0,onClick:y},{default:a(()=>[_(B(n.value>0?`重新发送 (${n.value}s)`:"发送验证码"),1)]),_:1},8,["disabled"])])]),_:1}),s(i,{label:"密码",prop:"password"},{default:a(()=>[s(l,{modelValue:r.password,"onUpdate:modelValue":e[3]||(e[3]=o=>r.password=o),type:"password","show-password":"",placeholder:"设置密码"},null,8,["modelValue"])]),_:1}),s(i,{label:"确认密码",prop:"confirmPassword"},{default:a(()=>[s(l,{modelValue:r.confirmPassword,"onUpdate:modelValue":e[4]||(e[4]=o=>r.confirmPassword=o),type:"password","show-password":"",placeholder:"再次输入密码"},null,8,["modelValue"])]),_:1}),s(w,{type:"primary",class:"full-button",loading:f.value,onClick:k},{default:a(()=>[...e[5]||(e[5]=[_(" 注册 ",-1)])]),_:1},8,["loading"])]),_:1},8,["model"]),t("div",z,[e[7]||(e[7]=t("span",null,"已有账号？",-1)),s(x,{to:"/login"},{default:a(()=>[...e[6]||(e[6]=[_("去登录",-1)])]),_:1})])])])}}},M=C(T,[["__scopeId","data-v-2289b447"]]);export{M as default};
