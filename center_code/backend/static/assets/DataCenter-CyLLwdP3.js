import{g as H,a as G,b as J}from"./dataCenter-De0rChME.js";import{_ as K,r as i,c as P,o as Q,a as z,b as m,d as a,f as t,g as c,n as W,E as N,p as X,e as l,F as Y,i as Z,j as V,l as f,t as r,q as R,H as ee}from"./index-BK2N8vuI.js";const ae={class:"data-center-page"},te={class:"filters"},le={class:"stats-cards"},se={class:"stat-value"},oe={class:"stat-value"},ne={class:"stat-value"},re={class:"stat-value"},de={class:"stat-value"},ie={class:"stat-value"},ue={class:"stat-value"},ce={class:"stat-value"},ve={__name:"DataCenter",setup(pe){const x=i(!1),g=i(!1),u=i({}),C=i([]),S=i([]),p=i([]),w=i(!1),h=i(!1),D=i([]),y=i(null),U=P(()=>y.value?`${y.value.account_name} 的视频数据`:"视频数据"),v=i({platform:"",account_id:null}),E=async()=>{try{g.value=!0;const o={platform:v.value.platform||void 0},e=await G(o);e.code===200&&(C.value=e.data)}catch(o){console.error("加载账号明细失败",o)}finally{g.value=!1}},k=async()=>{try{x.value=!0;const o={platform:v.value.platform||void 0,account_id:v.value.account_id||void 0};p.value&&p.value.length===2&&(o.start_date=p.value[0].toISOString(),o.end_date=p.value[1].toISOString());const e=await H(o);e.code===200&&(u.value=e.data),E()}catch(o){N.error("加载统计数据失败"),console.error(o)}finally{x.value=!1}},F=async()=>{var o;try{const e=await W.accounts.list({limit:1e3});if(e&&e.code===200){const _=((o=e.data)==null?void 0:o.accounts)||e.data||[];S.value=Array.isArray(_)?_:[]}}catch(e){console.error("加载账号列表失败:",e)}},I=()=>{v.value={platform:"",account_id:null},p.value=[],k()},$=async o=>{y.value=o,w.value=!0,await M(o.account_id)},M=async o=>{try{h.value=!0;const e=await J({account_id:o});e.code===200&&(D.value=e.data.videos)}catch(e){console.error("加载视频统计数据失败:",e),N.error("加载视频统计数据失败")}finally{h.value=!1}},O=o=>o?new Date(o).toLocaleString("zh-CN"):"";return Q(()=>{F(),k()}),(o,e)=>{const _=c("el-option"),A=c("el-select"),T=c("el-date-picker"),b=c("el-button"),d=c("el-card"),n=c("el-table-column"),j=c("el-tag"),B=c("el-table"),q=c("el-dialog"),L=X("loading");return m(),z("div",ae,[a(d,{shadow:"never"},{header:t(()=>[...e[5]||(e[5]=[l("div",{class:"card-header"},[l("h3",null,"数据中心")],-1)])]),default:t(()=>[l("div",te,[a(A,{modelValue:v.value.platform,"onUpdate:modelValue":e[0]||(e[0]=s=>v.value.platform=s),placeholder:"选择平台",clearable:"",style:{width:"150px","margin-right":"10px"}},{default:t(()=>[a(_,{label:"抖音",value:"douyin"}),a(_,{label:"快手",value:"kuaishou"}),a(_,{label:"小红书",value:"xiaohongshu"})]),_:1},8,["modelValue"]),a(A,{modelValue:v.value.account_id,"onUpdate:modelValue":e[1]||(e[1]=s=>v.value.account_id=s),placeholder:"选择账号",clearable:"",filterable:"",style:{width:"200px","margin-right":"10px"}},{default:t(()=>[(m(!0),z(Y,null,Z(S.value,s=>(m(),V(_,{key:s.id,label:s.account_name,value:s.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),a(T,{modelValue:p.value,"onUpdate:modelValue":e[2]||(e[2]=s=>p.value=s),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",style:{width:"300px","margin-right":"10px"}},null,8,["modelValue"]),a(b,{type:"primary",onClick:k},{default:t(()=>[...e[6]||(e[6]=[f("查询",-1)])]),_:1}),a(b,{onClick:I},{default:t(()=>[...e[7]||(e[7]=[f("重置",-1)])]),_:1})]),l("div",le,[a(d,{class:"stat-card",shadow:"hover"},{default:t(()=>[e[8]||(e[8]=l("div",{class:"stat-label"},"授权账号",-1)),l("div",se,r(u.value.authorized_accounts||0),1)]),_:1}),a(d,{class:"stat-card",shadow:"hover"},{default:t(()=>[e[9]||(e[9]=l("div",{class:"stat-label"},"发布视频数",-1)),l("div",oe,r(u.value.published_videos||0),1)]),_:1}),a(d,{class:"stat-card",shadow:"hover"},{default:t(()=>[e[10]||(e[10]=l("div",{class:"stat-label"},"总粉丝数",-1)),l("div",ne,r(u.value.total_followers||0),1)]),_:1}),a(d,{class:"stat-card",shadow:"hover"},{default:t(()=>[e[11]||(e[11]=l("div",{class:"stat-label"},"播放量",-1)),l("div",re,r(u.value.playbacks||0),1)]),_:1}),a(d,{class:"stat-card",shadow:"hover"},{default:t(()=>[e[12]||(e[12]=l("div",{class:"stat-label"},"点赞数",-1)),l("div",de,r(u.value.likes||0),1)]),_:1}),a(d,{class:"stat-card",shadow:"hover"},{default:t(()=>[e[13]||(e[13]=l("div",{class:"stat-label"},"评论数",-1)),l("div",ie,r(u.value.comments||0),1)]),_:1}),a(d,{class:"stat-card",shadow:"hover"},{default:t(()=>[e[14]||(e[14]=l("div",{class:"stat-label"},"净增粉丝数",-1)),l("div",ue,r(u.value.net_followers||0),1)]),_:1}),a(d,{class:"stat-card",shadow:"hover"},{default:t(()=>[e[15]||(e[15]=l("div",{class:"stat-label"},"分享数",-1)),l("div",ce,r(u.value.shares||0),1)]),_:1})]),a(d,{class:"account-ranking-card",shadow:"never",style:{"margin-top":"20px"}},{header:t(()=>[...e[16]||(e[16]=[l("div",{class:"card-header"},[l("h4",null,"账号数据明细")],-1)])]),default:t(()=>[R((m(),V(B,{data:C.value,style:{width:"100%"},stripe:""},{default:t(()=>[a(n,{prop:"account_name",label:"账号名称","min-width":"150","show-overflow-tooltip":""},{default:t(s=>[a(b,{type:"text",onClick:_e=>$(s.row)},{default:t(()=>[f(r(s.row.account_name),1)]),_:2},1032,["onClick"])]),_:1}),a(n,{prop:"platform",label:"平台",width:"100"},{default:t(s=>[a(j,{size:"small"},{default:t(()=>[f(r(s.row.platform),1)]),_:2},1024)]),_:1}),a(n,{prop:"published_videos",label:"发布视频数",sortable:"",width:"120",align:"center"}),a(n,{prop:"total_followers",label:"总粉丝数",sortable:"",width:"120",align:"center"}),a(n,{prop:"playbacks",label:"播放量",sortable:"",width:"120",align:"center"}),a(n,{prop:"likes",label:"点赞数",sortable:"",width:"120",align:"center"}),a(n,{prop:"comments",label:"评论数",sortable:"",width:"120",align:"center"}),a(n,{prop:"net_followers",label:"净增粉丝数",sortable:"",width:"120",align:"center"},{default:t(s=>[l("span",{class:ee(s.row.net_followers>0?"text-success":s.row.net_followers<0?"text-danger":"")},r(s.row.net_followers>0?"+":"")+r(s.row.net_followers),3)]),_:1}),a(n,{prop:"shares",label:"分享数",sortable:"",width:"120",align:"center"})]),_:1},8,["data"])),[[L,g.value]])]),_:1}),a(d,{class:"chart-card",shadow:"never",style:{"margin-top":"20px"}},{header:t(()=>[...e[17]||(e[17]=[l("h4",null,"数据趋势",-1)])]),default:t(()=>[e[18]||(e[18]=l("div",{class:"chart-placeholder"},null,-1))]),_:1})]),_:1}),a(q,{modelValue:w.value,"onUpdate:modelValue":e[4]||(e[4]=s=>w.value=s),title:U.value,width:"800px"},{footer:t(()=>[a(b,{onClick:e[3]||(e[3]=s=>w.value=!1)},{default:t(()=>[...e[19]||(e[19]=[f("关闭",-1)])]),_:1})]),default:t(()=>[R((m(),V(B,{data:D.value,style:{width:"100%"},stripe:""},{default:t(()=>[a(n,{prop:"video_title",label:"视频标题","min-width":"200","show-overflow-tooltip":""}),a(n,{prop:"publish_date",label:"发布日期",width:"180"},{default:t(s=>[f(r(O(s.row.publish_date)),1)]),_:1}),a(n,{prop:"playbacks",label:"播放量",width:"120",align:"center",sortable:""}),a(n,{prop:"likes",label:"点赞数",width:"120",align:"center",sortable:""}),a(n,{prop:"comments",label:"评论数",width:"120",align:"center",sortable:""}),a(n,{prop:"shares",label:"分享数",width:"120",align:"center",sortable:""})]),_:1},8,["data"])),[[L,h.value]])]),_:1},8,["modelValue","title"])])}}},we=K(ve,[["__scopeId","data-v-3d432a3f"]]);export{we as default};
